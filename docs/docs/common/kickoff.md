# 新人指引

---

## 开发流程

1. 评审阶段：产品召集前后端进行需求评审，前后端各自捋清楚自己的业务量以及联调之间工作量，从而进行开发时间评估。
2. 开发准备阶段：前后端一起商量需求中需要联调的部分，进行接口的口头协议交流。
3. 接口定义阶段：前后端中的一方根据之前的口头协议拟定出一份详细的接口，并书写 API 文档，完成后由另一方确认。有疑问的地方重新商量直至双方都没有问题。
4. 开发阶段：双方根据协商出来的接口为基础进行开发，如在开发过程中发现需要新增或删除一些字段，重复步骤 3。
5. 联调阶段：双方独自的工作完成，开始前后端联调，如在联调过程发现有疑问，重复步骤 3，直至联调完成。
6. 提测阶段：将完成的需求提给测试人员，让其对该需求进行测试，如发现问题，及时通知开发并让其修改，直至需求没有 bug。
7. 产品体验阶段：将完成的需求交给产品，让其体验，直至产品这边没有问题
8. 评审单发布阶段：前后端中的一人进行评审单的拟定，发送给对应的领导，表明需求发布的程序，包括影响到的页面及业务，发布的流程，发布的回滚方案等。
9. 发布阶段：前后端双方在保证步骤 1-8 都没有问题了，进行各自的代码发布，完成后由测试人员在线上进行相应的测试，如果有 bug，重复步骤 6 和 9，直至需求成功上线。

## GIT 规范

配置 .gitignore

```
/lib
/dist

# Logs
logs
*.log

# Runtime data
pids
*.pid
*.seed

# Directory for instrumented libs generated by jscoverage/JSCover
lib-cov

# Coverage directory used by tools like istanbul
coverage

# Grunt intermediate storage (http://gruntjs.com/creating-plugins#storing-task-files)
.grunt

# Compiled binary addons (http://nodejs.org/api/addons.html)
build/Release

# Dependency directory
# Deployed apps should consider commenting this line out:
# see https://npmjs.org/doc/faq.html#Should-I-check-my-node_modules-folder-into-git
node_modules

# =========================
# Operating System Files
# =========================

# OSX
# =========================

.DS_Store
.AppleDouble
.LSOverride

# Icon must ends with two \r.
Icon


# Thumbnails
._*

# Files that might appear on external disk
.Spotlight-V100
.Trashes

# Windows
# =========================

# Windows image file caches
Thumbs.db
ehthumbs.db

# Folder config file
Desktop.ini

# Recycle Bin used on file shares
$RECYCLE.BIN/

# Windows Installer files
*.cab
*.msi
*.msm
*.msp

```

### 代码提交规范

```bash
npm install --save-dev commitizen @wpg/cz-format
```

创建一个 `.czrc` 或者在 package.json 添加 `config`

`.czrc`

```json
{
  "path": "@wpg/cz-format"
}
```

`package.json`

```json
{
  "config": {
    "commitizen": {
      "path": "@wpg/cz-format"
    }
  }
}
```

创建 `.czferc.js`

```javascript
module.exports = {
  questions({inquirer, gitInfo}) {
    return [
      {...},
      {...},
    ]
  },
  commitMessage({answers, gitInfo}) {
    return ...
  }
}
```

## 项目创建

```bash
npm install -g @vue/cli
```

```bash
vue create hello-world
```

## 开发规范

参考[前端规范](https://guide.czh.vercel.app/)

### babel

```bash
npm install @babel/preset-env @vue/cli-plugin-babel --save-dev
```

```json
{
  "presets": [
    "@vue/cli-plugin-babel/preset",
    [
      "@babel/preset-env",
      {
        "useBuiltIns": "entry",
        "corejs": 3
      }
    ]
  ],
  "plugins": []
}
```

### eslint

项目配置 .eslintrc.js

```bash
npm install eslint @wpg/eslint-config --save-dev
```

[配置参考](http://10.10.102.223/WPG_SRC_WEB/eslint-config/blob/master/README.md)

```javascript
// .eslintrc.js
module.exports = {
  extends: ['@wpg']
};
```

### vue

```bash
npm install eslint @wpg/eslint-config-vue --save-dev
```

```javascript
// .eslintrc.js
module.exports = {
  extends: ['@wpg/vue']
};
```

### typescript

```bash
npm install eslint @wpg/eslint-config-ts --save-dev
```

```javascript
// .eslintrc.js
module.exports = {
  extends: ['@wpg/ts']
};
```

### typescript & vue

```bash
npm install eslint @wpg/eslint-config-ts @wpg/eslint-config-vue-ts --save-dev
```

```javascript
// .eslintrc.js
module.exports = {
  extends: ['@wpg/ts', '@wpg/vue-ts']
};
```

### stylelint

配置 .stylelintrc

```bash
npm install --save-dev stylelint @wpg/stylelint-config
```

```json
{
  "extends": [
    // other configs ...
    "@wpg/stylelint-config"
  ]
}
```

配置 .eslintignore

```
dist
node_modules

```

### prettier

配置 .prettierrc

```json
{
  "printWidth": 120,
  "tabWidth": 2,
  "useTabs": false,
  "semi": true,
  "singleQuote": true,
  "quoteProps": "as-needed",
  "jsxSingleQuote": false,
  "trailingComma": "none",
  "bracketSpacing": true,
  "jsxBracketSameLine": false,
  "arrowParens": "always",
  "requirePragma": false,
  "insertPragma": false,
  "proseWrap": "preserve",
  "htmlWhitespaceSensitivity": "css",
  "vueIndentScriptAndStyle": false,
  "endOfLine": "lf",
  "embeddedLanguageFormatting": "auto"
}
```

配置 .prettierignore

```
/dist/*
.local
.output.js
/node_modules/**

**/*.svg
**/*.sh

/public/*

```

## 代码编辑器

### vscode

1. 安装插件 [Settings Sync](https://marketplace.visualstudio.com/items?itemName=Shan.code-settings-sync)
2. 同步配置 https://gist.github.com/ittiam/0fc51ecd8295fe682836e58b02da5bcb

通过配置 .vscode/settings.json 来支持自动修复 Prettier 和 ESLint 错误：

```json
{
  "files.eol": "\n",
  "editor.tabSize": 2,
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "eslint.validate": ["javascript", "javascriptreact", "vue", "typescript", "typescriptreact"],
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true,
    "source.fixAll.stylelint": true
  }
}
```

配置 jsconfig.json

```json
{
  "exclude": ["node_modules"],
  "include": ["./src/**/*", "mock"],
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  }
}
```

配置 tsconfig.json

```json
{
  "include": ["src/**/*.ts", "src/**/*.tsx", "src/**/*.vue"],
  "exclude": ["node_modules"],
  "compilerOptions": {
    "target": "esnext",
    "module": "esnext",
    "lib": ["esnext", "dom", "dom.iterable", "scripthost"],
    "strict": true,
    "jsx": "preserve",
    "importHelpers": true,
    "moduleResolution": "node",
    "experimentalDecorators": true,
    "esModuleInterop": true,
    "allowSyntheticDefaultImports": true,
    "sourceMap": true,
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  }
}
```

配置参考:

```json
{
  // ===
  // Editor
  // ===
  "editor.fontFamily": "'Consolas', 'LXGW WenKai'",
  "editor.fontLigatures": true,
  "editor.fontSize": 15,
  "editor.minimap.enabled": true,
  "editor.multiCursorModifier": "alt",
  "editor.renderControlCharacters": true,
  "editor.renderWhitespace": "all",
  "editor.snippetSuggestions": "top",
  "editor.rulers": [100, 120],
  "editor.inlineSuggest.enabled": true,

  // ===
  // Workbench
  // ===
  "workbench.colorTheme": "Gruvbox Dark Hard",
  "workbench.iconTheme": "material-icon-theme",
  "workbench.productIconTheme": "fluent-icons",

  // ===
  // Spacing
  // ===
  "editor.insertSpaces": true,
  "editor.tabSize": 2,
  "editor.detectIndentation": false,
  "editor.trimAutoWhitespace": true,
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true,
    "source.fixAll.stylelint": true
  },
  "editor.suggestSelection": "first",
  "vsintellicode.modify.editor.suggestSelection": "automaticallyOverrodeDefaultValue",
  "files.insertFinalNewline": true,
  "files.trimFinalNewlines": true,

  // ===
  // Files
  // ===
  "files.exclude": {
    "**/*.log": true,
    "**/*.log*": true,
    "**/coverage": true
  },
  "files.eol": "\n",
  "files.trimTrailingWhitespace": true,
  "filesize.showGzip": false,
  "files.associations": {
    ".markdownlintrc": "jsonc",
    "*.nvue": "vue"
  },

  // ===
  // Event Triggers
  // ===
  "editor.formatOnSave": true,
  // 设置各种代码的默认格式化器//以下为默认配置
  "[html]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[css]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[less]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[javascript]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[typescript]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[jsonc]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[vue]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },

  // ===
  // ESLINT
  // ===
  "eslint.format.enable": true,
  "eslint.validate": ["javascript", "javascriptreact", "vue", "typescript", "typescriptreact"],

  // ===
  // VETUR
  // ===
  "vetur.format.enable": true, // 设置是否禁用插件格式化功能 // 默认为true，即开启
  "vetur.format.defaultFormatter.css": "prettier", // 设置css代码(<style>包含的代码块）默认格式化器
  "vetur.format.defaultFormatter.sass": "sass-formatter",
  "vetur.format.defaultFormatter.postcss": "prettier",
  "vetur.format.defaultFormatter.scss": "prettier",
  "vetur.format.defaultFormatter.less": "prettier",
  "vetur.format.defaultFormatter.stylus": "stylus-supremacy",
  "vetur.format.defaultFormatter.html": "prettier", // 设置html代码(<template>包含的代码块)默认格式化器
  "vetur.format.defaultFormatter.js": "prettier-eslint", // 设置js代码<script>包含的代码块）默认格式化器
  "vetur.format.defaultFormatter.ts": "prettier", // 设置vetur默认使用 prettier格式化代码
  "vetur.format.options.tabSize": 2, // 设置tab键占用的空格数，该配置将被所有格式化器继承
  "vetur.format.options.useTabs": false, // 设置是否使用tab键缩进 默认false，即不使用，该配置将被所有格式化器继承

  // ===
  // HTML
  // ===
  "html.format.enable": false,
  "emmet.triggerExpansionOnTab": true,
  "vetur.validation.template": true,
  "vetur.completion.tagCasing": "initial",

  // ===
  // JS(ON)
  // ===
  "javascript.format.enable": false,
  "typescript.format.enable": false,
  "json.format.enable": false,
  "vetur.validation.script": true,

  // ===
  // CSS
  // ===
  "stylelint.enable": true,
  "css.validate": false,
  "less.validate": false,
  "scss.validate": false,
  "vetur.validation.style": true,
  "stylelint.validate": [
    "css",
    "html",
    "less",
    "postcss",
    "sass",
    "scss",
    "source.css.styled",
    "source.markdown.math",
    "styled-css",
    "sugarss",
    "vue",
    "vue-html",
    "vue-postcss"
  ],

  // ===
  // MARKDOWN
  // ===
  "[markdown]": {
    "editor.wordWrap": "wordWrapColumn",
    "editor.wordWrapColumn": 120,
    "editor.defaultFormatter": "yzhang.markdown-all-in-one"
  },

  // ===
  // GIT
  // ===
  "git.autofetch": true,
  "git.enableSmartCommit": true,
  "gitlens.advanced.messages": {
    "suppressCommitHasNoPreviousCommitWarning": false,
    "suppressCommitNotFoundWarning": false,
    "suppressFileNotUnderSourceControlWarning": false,
    "suppressGitVersionWarning": false,
    "suppressLineUncommittedWarning": false,
    "suppressNoRepositoryWarning": false
  },

  // ===
  // Terminal
  // ===
  "terminal.integrated.fontSize": 15,

  // ===
  // Plugins
  // ===
  "htmltagwrap.tag": "div",
  "px-to-rem.px-per-rem": 100,
  "advancedNewFile.convenienceOptions": ["current", "last", "root"],
  "advancedNewFile.exclude": {
    "dev": true,
    "dist": true,
    "node_modules": true,
    "node_modules_electron": true
  },
  "advancedNewFile.showInformationMessages": true,

  // ===
  // Sync
  // ===
  "sync.autoDownload": false,
  "sync.autoUpload": false,
  "sync.forceDownload": false,
  "sync.gist": "0fc51ecd8295fe682836e58b02da5bcb",
  "sync.quietSync": false,
  "sync.removeExtensions": true,
  "sync.syncExtensions": true,
  "editor.quickSuggestions": {
    "strings": true
  },

  // ===
  // Prettier
  // ===
  "prettier.enable": true, // 设置是否开启prettier插件，默认为true，即开启
  "prettier.semi": false, // 设置是否在每行末尾添加分号，默认为 true
  "prettier.singleQuote": true, // 设置格式化时，保持单引号，如果设置为true，则单引号会自动变成双引号
  "prettier.tabWidth": 2, // 设置每个tab占用多少个空格
  "prettier.printWidth": 120, // 设置每行可容纳字符数
  "prettier.useTabs": false, // 设置是否使用tab键缩进行，默认为false，即不使用
  "prettier.bracketSpacing": true, // 在对象，括号与文字之间加空格 true - Example: { foo: bar }   false - Example: {foo: bar}， 默认为true
  "prettier.trailingComma": "none",
  "prettier.jsxBracketSameLine": true
}

```
